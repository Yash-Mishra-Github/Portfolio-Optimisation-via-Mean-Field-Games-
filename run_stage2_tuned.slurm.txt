#!/bin/bash
#SBATCH --job-name=stage2_tuned
#SBATCH --output=logs/stage2_tuned_%j.out
#SBATCH --error=logs/stage2_tuned_%j.err
#SBATCH --time=48:00:00
#SBATCH --ntasks=1
#SBATCH --cpus-per-task=12
#SBATCH --mem=48G
#SBATCH --partition=cpu
#SBATCH --qos=long

module load Anaconda3
source activate mfg_env

echo "Running Stage II tuned (train_mfg.py, Transformer + signatures, longer run)"
srun python -u src/train_mfg.py \
  --model transformer \
  --data data/processed_market_data.csv \
  --out outputs/stage2_tuned_${SLURM_JOB_ID} \
  --iters 4000 \
  --N 1024 \
  --K 252 \
  --lr 0.0002 \
  --loss custom

